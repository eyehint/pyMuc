from objs.config import MAIN_CONFIG

MagicMap = {
  'íˆ¬êµ¬': 
  {
      'í˜': 400,
      'ë¯¼ì²©ì„±': 200,
      'ë§·ì§‘': 200,
      'ì²´ë ¥': MAIN_CONFIG['ì²´ë ¥ì˜µì…˜ê³ '],
      'ë‚´ê³µ': 10,
      'ëª…ì¤‘': 20,
      'í•„ì‚´': 20,
      'ìš´': 20,
      'íšŒí”¼': 20,
      'ê²½í—˜ì¹˜': 0,
      'ë§ˆë²•ë°œê²¬': 0,
      'ê³µê²©ë ¥': 0,
      'ë°©ì–´ë ¥': 200,
  },
  'ì™•ê´€': 
  {
      'í˜': 0,
      'ë¯¼ì²©ì„±': 0,
      'ë§·ì§‘': 0,
      'ì²´ë ¥': 0,
      'ë‚´ê³µ': 0,
      'ëª…ì¤‘': 0,
      'í•„ì‚´': 0,
      'ìš´': 0,
      'íšŒí”¼': 0,
      'ê²½í—˜ì¹˜': 0,
      'ë§ˆë²•ë°œê²¬': 0,
      'ê³µê²©ë ¥': 0,
      'ë°©ì–´ë ¥': 0,
  },
  'ë¨¸ë¦¬': 
  {
      'í˜': 200,
      'ë¯¼ì²©ì„±': 100,
      'ë§·ì§‘': 200,
      'ì²´ë ¥': MAIN_CONFIG['ì²´ë ¥ì˜µì…˜ì¤‘'],
      'ë‚´ê³µ': 10,
      'ëª…ì¤‘': 20,
      'í•„ì‚´': 20,
      'ìš´': 20,
      'íšŒí”¼': 20,
      'ê²½í—˜ì¹˜': 0,
      'ë§ˆë²•ë°œê²¬': 0,
      'ê³µê²©ë ¥': 0,
      'ë°©ì–´ë ¥': 200,
  },
  'ê·€ê±¸ì´': 
  {
      'í˜': 200,
      'ë¯¼ì²©ì„±': 200,
      'ë§·ì§‘': 0,
      'ì²´ë ¥': 0,
      'ë‚´ê³µ': 10,
      'ëª…ì¤‘': 20,
      'í•„ì‚´': 20,
      'ìš´': 20,
      'íšŒí”¼': 20,
      'ê²½í—˜ì¹˜': 0,
      'ë§ˆë²•ë°œê²¬': 0,
      'ê³µê²©ë ¥': 0,
      'ë°©ì–´ë ¥': 0,
  },
  'ëª©ê±¸ì´': 
  {
      'í˜': 200,
      'ë¯¼ì²©ì„±': 200,
      'ë§·ì§‘': 0,
      'ì²´ë ¥': 0,
      'ë‚´ê³µ': 10,
      'ëª…ì¤‘': 40,
      'í•„ì‚´': 40,
      'ìš´': 20,
      'íšŒí”¼': 20,
      'ê²½í—˜ì¹˜': 0,
      'ë§ˆë²•ë°œê²¬': 0,
      'ê³µê²©ë ¥': 0,
      'ë°©ì–´ë ¥': 200,
  },
  'ì–´ê¹¨': 
  {
      'í˜': 400,
      'ë¯¼ì²©ì„±': 100,
      'ë§·ì§‘': 200,
      'ì²´ë ¥': MAIN_CONFIG['ì²´ë ¥ì˜µì…˜ê³ '],
      'ë‚´ê³µ': 10,
      'ëª…ì¤‘': 20,
      'í•„ì‚´': 20,
      'ìš´': 20,
      'íšŒí”¼': 20,
      'ê²½í—˜ì¹˜': 0,
      'ë§ˆë²•ë°œê²¬': 0,
      'ê³µê²©ë ¥': 0,
      'ë°©ì–´ë ¥': 200,
  },
  'ìƒì˜': 
  {
      'í˜': 400,
      'ë¯¼ì²©ì„±': 100,
      'ë§·ì§‘': 200,
      'ì²´ë ¥': MAIN_CONFIG['ì²´ë ¥ì˜µì…˜ê³ '],
      'ë‚´ê³µ': 10,
      'ëª…ì¤‘': 20,
      'í•„ì‚´': 20,
      'ìš´': 20,
      'íšŒí”¼': 20,
      'ê²½í—˜ì¹˜': 0,
      'ë§ˆë²•ë°œê²¬': 0,
      'ê³µê²©ë ¥': 0,
      'ë°©ì–´ë ¥': 200,
  },
  'í•˜ì˜': 
  {
      'í˜': 400,
      'ë¯¼ì²©ì„±': 100,
      'ë§·ì§‘': 200,
      'ì²´ë ¥': MAIN_CONFIG['ì²´ë ¥ì˜µì…˜ê³ '],
      'ë‚´ê³µ': 10,
      'ëª…ì¤‘': 20,
      'í•„ì‚´': 20,
      'ìš´': 20,
      'íšŒí”¼': 20,
      'ê²½í—˜ì¹˜': 0,
      'ë§ˆë²•ë°œê²¬': 0,
      'ê³µê²©ë ¥': 0,
      'ë°©ì–´ë ¥': 200,
  },
  'ì¥ì‹ êµ¬':
  {
      'í˜': 200,
      'ë¯¼ì²©ì„±': 100,
      'ë§·ì§‘': 0,
      'ì²´ë ¥': 0,
      'ë‚´ê³µ': 10,
      'ëª…ì¤‘': 20,
      'í•„ì‚´': 20,
      'ìš´': 20,
      'íšŒí”¼': 20,
      'ê²½í—˜ì¹˜': 0,
      'ë§ˆë²•ë°œê²¬': 0,
      'ê³µê²©ë ¥': 0,
      'ë°©ì–´ë ¥': 200,
  },
  'ê°‘ì˜·': 
  {
      'í˜': 400,
      'ë¯¼ì²©ì„±': 100,
      'ë§·ì§‘': 200,
      'ì²´ë ¥': MAIN_CONFIG['ì²´ë ¥ì˜µì…˜ê³ '],
      'ë‚´ê³µ': 10,
      'ëª…ì¤‘': 20,
      'í•„ì‚´': 20,
      'ìš´': 20,
      'íšŒí”¼': 20,
      'ê²½í—˜ì¹˜': 0,
      'ë§ˆë²•ë°œê²¬': 0,
      'ê³µê²©ë ¥': 0,
      'ë°©ì–´ë ¥': 200,
  },
  'í—ˆë¦¬': 
  {
      'í˜': 200,
      'ë¯¼ì²©ì„±': 100,
      'ë§·ì§‘': 200,
      'ì²´ë ¥': MAIN_CONFIG['ì²´ë ¥ì˜µì…˜ê³ '],
      'ë‚´ê³µ': 10,
      'ëª…ì¤‘': 20,
      'í•„ì‚´': 20,
      'ìš´': 20,
      'íšŒí”¼': 20,
      'ê²½í—˜ì¹˜': 0,
      'ë§ˆë²•ë°œê²¬': 0,
      'ê³µê²©ë ¥': 0,
      'ë°©ì–´ë ¥': 200,
  },
  'íŒ”ì°Œ': 
  {
      'í˜': 200,
      'ë¯¼ì²©ì„±': 100,
      'ë§·ì§‘': 0,
      'ì²´ë ¥': 0,
      'ë‚´ê³µ': 10,
      'ëª…ì¤‘': 20,
      'í•„ì‚´': 20,
      'ìš´': 20,
      'íšŒí”¼': 20,
      'ê²½í—˜ì¹˜': 0,
      'ë§ˆë²•ë°œê²¬': 0,
      'ê³µê²©ë ¥': 0,
      'ë°©ì–´ë ¥': 0,
  },
  'ì¥ê°‘': 
  {
      'í˜': 200,
      'ë¯¼ì²©ì„±': 100,
      'ë§·ì§‘': 100,
      'ì²´ë ¥': MAIN_CONFIG['ì²´ë ¥ì˜µì…˜ì €'],
      'ë‚´ê³µ': 10,
      'ëª…ì¤‘': 30,
      'í•„ì‚´': 20,
      'ìš´': 20,
      'íšŒí”¼': 20,
      'ê²½í—˜ì¹˜': 0,
      'ë§ˆë²•ë°œê²¬': 0,
      'ê³µê²©ë ¥': 0,
      'ë°©ì–´ë ¥': 200,
  },
  'ë°˜ì§€': 
  {
      'í˜': 200,
      'ë¯¼ì²©ì„±': 100,
      'ë§·ì§‘': 0,
      'ì²´ë ¥': 0,
      'ë‚´ê³µ': 10,
      'ëª…ì¤‘': 20,
      'í•„ì‚´': 20,
      'ìš´': 20,
      'íšŒí”¼': 20,
      'ê²½í—˜ì¹˜': 0,
      'ë§ˆë²•ë°œê²¬': 0,
      'ê³µê²©ë ¥': 0,
      'ë°©ì–´ë ¥': 0,
  },
  'ìŠ¬í˜¸': 
  {
      'í˜': 200,
      'ë¯¼ì²©ì„±': 100,
      'ë§·ì§‘': 200,
      'ì²´ë ¥': MAIN_CONFIG['ì²´ë ¥ì˜µì…˜ê³ '],
      'ë‚´ê³µ': 10,
      'ëª…ì¤‘': 20,
      'í•„ì‚´': 20,
      'ìš´': 20,
      'íšŒí”¼': 20,
      'ê²½í—˜ì¹˜': 0,
      'ë§ˆë²•ë°œê²¬': 0,
      'ê³µê²©ë ¥': 0,
      'ë°©ì–´ë ¥': 200,
  },
  'ì‹ ë°œ': 
  {
      'í˜': 200,
      'ë¯¼ì²©ì„±': 100,
      'ë§·ì§‘': 100,
      'ì²´ë ¥': MAIN_CONFIG['ì²´ë ¥ì˜µì…˜ê³ '],
      'ë‚´ê³µ': 10,
      'ëª…ì¤‘': 20,
      'í•„ì‚´': 20,
      'ìš´': 20,
      'íšŒí”¼': 20,
      'ê²½í—˜ì¹˜': 0,
      'ë§ˆë²•ë°œê²¬': 0,
      'ê³µê²©ë ¥': 0,
      'ë°©ì–´ë ¥': 200,
  },
  'ë¬´ê¸°': 
  {
      'í˜': 1000,
      'ë¯¼ì²©ì„±': 0,
      'ë§·ì§‘': 300,
      'ì²´ë ¥': MAIN_CONFIG['ì²´ë ¥ì˜µì…˜ì¤‘'],
      'ë‚´ê³µ': 10,
      'ëª…ì¤‘': 30,
      'í•„ì‚´': 30,
      'ìš´': 30,
      'íšŒí”¼': 30,
      'ê²½í—˜ì¹˜': 0,
      'ë§ˆë²•ë°œê²¬': 0,
      'ê³µê²©ë ¥': 0,
      'ë°©ì–´ë ¥': 0,
  },
  'ê¸°íƒ€':
  {
      'í˜': 0,
      'ë¯¼ì²©ì„±': 0,
      'ë§·ì§‘': 0,
      'ì²´ë ¥': 0,
      'ë‚´ê³µ': 0,
      'ëª…ì¤‘': 0,
      'í•„ì‚´': 0,
      'ìš´': 0,
      'íšŒí”¼': 0,
      'ê²½í—˜ì¹˜': 0,
      'ë§ˆë²•ë°œê²¬': 0,
      'ê³µê²©ë ¥': 0,
      'ë°©ì–´ë ¥': 0,
  },
}

OptionName = ['í˜', 'ë¯¼ì²©ì„±', 'ë§·ì§‘', 'ì²´ë ¥', 'ë‚´ê³µ', 'ëª…ì¤‘', 'í•„ì‚´', 'ìš´', 'íšŒí”¼', 'ê²½í—˜ì¹˜', 'ë§ˆë²•ë°œê²¬', 'ê³µê²©ë ¥', 'ë°©ì–´ë ¥']

def applyMagic(self, level, num = 0, force = 0):
    from random import randint
    l = level
    option = {}
    position = self['ê³„ì¸µ']
    if position == '':
        return
    if self['ì¢…ë¥˜'] != 'ë¬´ê¸°' and self['ì¢…ë¥˜'] != 'ë°©ì–´êµ¬':
        return
    if self['ì˜µì…˜'] is not None and self['ì˜µì…˜'] != "":
        return
    if force == 1:
        level += 500
    else:
        if randint(0, 4) != 0:
            return
    if num == 0:
        num = randint(0, 5 * level // 10001 + 1)
    if randint(0, 10) == 10:
        num += 1
    if randint(0, 20) == 20:
        num += 1
    if randint(0, 50) == 50:
        num += 1

    if force == 1 and num == 0:
        num = 1

    if num == 0:
        return

    if num > 4:
        num = 4

    level += level * (num - 1) / 4

    if level > 10000:
        level = 10000

    optionMap = self.MagicMap[position]
    i = 0
    cnt = 0
    z = False
    while i < num:
        cnt += 1
        if cnt > 8:
            return
        nOp = randint(0, len(self.OptionName) - 1)
        op = self.OptionName[nOp]
        if op in option:
            continue
        maxval = optionMap[op]
        if maxval == 0:
            continue
        #val = randint(0, maxval)
        m = level * maxval / 10000 
        val = randint(int(m / 2), int(m * 1.5))
        if val > maxval:
            val = maxval
        if val == 0:
            continue
       
        if val > maxval * 0.3:
            z = True
       
        if op in ['ê³µê²©ë ¥', 'ë°©ì–´ë ¥']:
            self[op] = self[op] + val
        option[op] = val
        i += 1
    self['ë ˆë²¨'] = l
    if self['ì¢…ë¥˜'] == 'ë°©ì–´êµ¬':
        de = self['ë°©ì–´ë ¥']  
        d = int(l / 20)
        d += randint(-d/10, d/10)

        #if d > de * 3:
        #    z = True

        if de < d:
            self['ë°©ì–´ë ¥'] = d

    self.setOption(option)

    name = self['ì´ë¦„']
    name1 = self.getStrip('ì´ë¦„')
    print(name, self.getOptionStr())

    if num > 2 or z == True:
        self.setAttr('ì•„ì´í…œì†ì„±', 'ë²„ë¦¬ì§€ëª»í•¨')
        self.setAttr('ì•„ì´í…œì†ì„±', 'ì¤„ìˆ˜ì—†ìŒ')

    if name == name1:
        if num < 3:
            self['ì´ë¦„'] = '[1;34m' + name + '[0;37m'
        elif num == 3:
            self['ì´ë¦„'] = '[1;37m' + name + '[0;37m'
        elif num == 4:
            self['ì´ë¦„'] = '[1;33m' + name + '[0;37m'


    
