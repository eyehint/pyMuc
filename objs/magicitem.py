# -*- coding: euc-kr -*-

from objs.config import MAIN_CONFIG

MagicMap = {
  'Åõ±¸': 
  {
      'Èû': 400,
      '¹ÎÃ¸¼º': 200,
      '¸ËÁı': 200,
      'Ã¼·Â': MAIN_CONFIG['Ã¼·Â¿É¼Ç°í'],
      '³»°ø': 10,
      '¸íÁß': 20,
      'ÇÊ»ì': 20,
      '¿î': 20,
      'È¸ÇÇ': 20,
      '°æÇèÄ¡': 0,
      '¸¶¹ı¹ß°ß': 0,
      '°ø°İ·Â': 0,
      '¹æ¾î·Â': 200,
  },
  '¿Õ°ü': 
  {
      'Èû': 0,
      '¹ÎÃ¸¼º': 0,
      '¸ËÁı': 0,
      'Ã¼·Â': 0,
      '³»°ø': 0,
      '¸íÁß': 0,
      'ÇÊ»ì': 0,
      '¿î': 0,
      'È¸ÇÇ': 0,
      '°æÇèÄ¡': 0,
      '¸¶¹ı¹ß°ß': 0,
      '°ø°İ·Â': 0,
      '¹æ¾î·Â': 0,
  },
  '¸Ó¸®': 
  {
      'Èû': 200,
      '¹ÎÃ¸¼º': 100,
      '¸ËÁı': 200,
      'Ã¼·Â': MAIN_CONFIG['Ã¼·Â¿É¼ÇÁß'],
      '³»°ø': 10,
      '¸íÁß': 20,
      'ÇÊ»ì': 20,
      '¿î': 20,
      'È¸ÇÇ': 20,
      '°æÇèÄ¡': 0,
      '¸¶¹ı¹ß°ß': 0,
      '°ø°İ·Â': 0,
      '¹æ¾î·Â': 200,
  },
  '±Í°ÉÀÌ': 
  {
      'Èû': 200,
      '¹ÎÃ¸¼º': 200,
      '¸ËÁı': 0,
      'Ã¼·Â': 0,
      '³»°ø': 10,
      '¸íÁß': 20,
      'ÇÊ»ì': 20,
      '¿î': 20,
      'È¸ÇÇ': 20,
      '°æÇèÄ¡': 0,
      '¸¶¹ı¹ß°ß': 0,
      '°ø°İ·Â': 0,
      '¹æ¾î·Â': 0,
  },
  '¸ñ°ÉÀÌ': 
  {
      'Èû': 200,
      '¹ÎÃ¸¼º': 200,
      '¸ËÁı': 0,
      'Ã¼·Â': 0,
      '³»°ø': 10,
      '¸íÁß': 40,
      'ÇÊ»ì': 40,
      '¿î': 20,
      'È¸ÇÇ': 20,
      '°æÇèÄ¡': 0,
      '¸¶¹ı¹ß°ß': 0,
      '°ø°İ·Â': 0,
      '¹æ¾î·Â': 200,
  },
  '¾î±ú': 
  {
      'Èû': 400,
      '¹ÎÃ¸¼º': 100,
      '¸ËÁı': 200,
      'Ã¼·Â': MAIN_CONFIG['Ã¼·Â¿É¼Ç°í'],
      '³»°ø': 10,
      '¸íÁß': 20,
      'ÇÊ»ì': 20,
      '¿î': 20,
      'È¸ÇÇ': 20,
      '°æÇèÄ¡': 0,
      '¸¶¹ı¹ß°ß': 0,
      '°ø°İ·Â': 0,
      '¹æ¾î·Â': 200,
  },
  '»óÀÇ': 
  {
      'Èû': 400,
      '¹ÎÃ¸¼º': 100,
      '¸ËÁı': 200,
      'Ã¼·Â': MAIN_CONFIG['Ã¼·Â¿É¼Ç°í'],
      '³»°ø': 10,
      '¸íÁß': 20,
      'ÇÊ»ì': 20,
      '¿î': 20,
      'È¸ÇÇ': 20,
      '°æÇèÄ¡': 0,
      '¸¶¹ı¹ß°ß': 0,
      '°ø°İ·Â': 0,
      '¹æ¾î·Â': 200,
  },
  'ÇÏÀÇ': 
  {
      'Èû': 400,
      '¹ÎÃ¸¼º': 100,
      '¸ËÁı': 200,
      'Ã¼·Â': MAIN_CONFIG['Ã¼·Â¿É¼Ç°í'],
      '³»°ø': 10,
      '¸íÁß': 20,
      'ÇÊ»ì': 20,
      '¿î': 20,
      'È¸ÇÇ': 20,
      '°æÇèÄ¡': 0,
      '¸¶¹ı¹ß°ß': 0,
      '°ø°İ·Â': 0,
      '¹æ¾î·Â': 200,
  },
  'Àå½Å±¸':
  {
      'Èû': 200,
      '¹ÎÃ¸¼º': 100,
      '¸ËÁı': 0,
      'Ã¼·Â': 0,
      '³»°ø': 10,
      '¸íÁß': 20,
      'ÇÊ»ì': 20,
      '¿î': 20,
      'È¸ÇÇ': 20,
      '°æÇèÄ¡': 0,
      '¸¶¹ı¹ß°ß': 0,
      '°ø°İ·Â': 0,
      '¹æ¾î·Â': 200,
  },
  '°©¿Ê': 
  {
      'Èû': 400,
      '¹ÎÃ¸¼º': 100,
      '¸ËÁı': 200,
      'Ã¼·Â': MAIN_CONFIG['Ã¼·Â¿É¼Ç°í'],
      '³»°ø': 10,
      '¸íÁß': 20,
      'ÇÊ»ì': 20,
      '¿î': 20,
      'È¸ÇÇ': 20,
      '°æÇèÄ¡': 0,
      '¸¶¹ı¹ß°ß': 0,
      '°ø°İ·Â': 0,
      '¹æ¾î·Â': 200,
  },
  'Çã¸®': 
  {
      'Èû': 200,
      '¹ÎÃ¸¼º': 100,
      '¸ËÁı': 200,
      'Ã¼·Â': MAIN_CONFIG['Ã¼·Â¿É¼Ç°í'],
      '³»°ø': 10,
      '¸íÁß': 20,
      'ÇÊ»ì': 20,
      '¿î': 20,
      'È¸ÇÇ': 20,
      '°æÇèÄ¡': 0,
      '¸¶¹ı¹ß°ß': 0,
      '°ø°İ·Â': 0,
      '¹æ¾î·Â': 200,
  },
  'ÆÈÂî': 
  {
      'Èû': 200,
      '¹ÎÃ¸¼º': 100,
      '¸ËÁı': 0,
      'Ã¼·Â': 0,
      '³»°ø': 10,
      '¸íÁß': 20,
      'ÇÊ»ì': 20,
      '¿î': 20,
      'È¸ÇÇ': 20,
      '°æÇèÄ¡': 0,
      '¸¶¹ı¹ß°ß': 0,
      '°ø°İ·Â': 0,
      '¹æ¾î·Â': 0,
  },
  'Àå°©': 
  {
      'Èû': 200,
      '¹ÎÃ¸¼º': 100,
      '¸ËÁı': 100,
      'Ã¼·Â': MAIN_CONFIG['Ã¼·Â¿É¼ÇÀú'],
      '³»°ø': 10,
      '¸íÁß': 30,
      'ÇÊ»ì': 20,
      '¿î': 20,
      'È¸ÇÇ': 20,
      '°æÇèÄ¡': 0,
      '¸¶¹ı¹ß°ß': 0,
      '°ø°İ·Â': 0,
      '¹æ¾î·Â': 200,
  },
  '¹İÁö': 
  {
      'Èû': 200,
      '¹ÎÃ¸¼º': 100,
      '¸ËÁı': 0,
      'Ã¼·Â': 0,
      '³»°ø': 10,
      '¸íÁß': 20,
      'ÇÊ»ì': 20,
      '¿î': 20,
      'È¸ÇÇ': 20,
      '°æÇèÄ¡': 0,
      '¸¶¹ı¹ß°ß': 0,
      '°ø°İ·Â': 0,
      '¹æ¾î·Â': 0,
  },
  '½½È£': 
  {
      'Èû': 200,
      '¹ÎÃ¸¼º': 100,
      '¸ËÁı': 200,
      'Ã¼·Â': MAIN_CONFIG['Ã¼·Â¿É¼Ç°í'],
      '³»°ø': 10,
      '¸íÁß': 20,
      'ÇÊ»ì': 20,
      '¿î': 20,
      'È¸ÇÇ': 20,
      '°æÇèÄ¡': 0,
      '¸¶¹ı¹ß°ß': 0,
      '°ø°İ·Â': 0,
      '¹æ¾î·Â': 200,
  },
  '½Å¹ß': 
  {
      'Èû': 200,
      '¹ÎÃ¸¼º': 100,
      '¸ËÁı': 100,
      'Ã¼·Â': MAIN_CONFIG['Ã¼·Â¿É¼Ç°í'],
      '³»°ø': 10,
      '¸íÁß': 20,
      'ÇÊ»ì': 20,
      '¿î': 20,
      'È¸ÇÇ': 20,
      '°æÇèÄ¡': 0,
      '¸¶¹ı¹ß°ß': 0,
      '°ø°İ·Â': 0,
      '¹æ¾î·Â': 200,
  },
  '¹«±â': 
  {
      'Èû': 1000,
      '¹ÎÃ¸¼º': 0,
      '¸ËÁı': 300,
      'Ã¼·Â': MAIN_CONFIG['Ã¼·Â¿É¼ÇÁß'],
      '³»°ø': 10,
      '¸íÁß': 30,
      'ÇÊ»ì': 30,
      '¿î': 30,
      'È¸ÇÇ': 30,
      '°æÇèÄ¡': 0,
      '¸¶¹ı¹ß°ß': 0,
      '°ø°İ·Â': 0,
      '¹æ¾î·Â': 0,
  },
  '±âÅ¸':
  {
      'Èû': 0,
      '¹ÎÃ¸¼º': 0,
      '¸ËÁı': 0,
      'Ã¼·Â': 0,
      '³»°ø': 0,
      '¸íÁß': 0,
      'ÇÊ»ì': 0,
      '¿î': 0,
      'È¸ÇÇ': 0,
      '°æÇèÄ¡': 0,
      '¸¶¹ı¹ß°ß': 0,
      '°ø°İ·Â': 0,
      '¹æ¾î·Â': 0,
  },
}

OptionName = ['Èû', '¹ÎÃ¸¼º', '¸ËÁı', 'Ã¼·Â', '³»°ø', '¸íÁß', 'ÇÊ»ì', '¿î', 'È¸ÇÇ', '°æÇèÄ¡', '¸¶¹ı¹ß°ß', '°ø°İ·Â', '¹æ¾î·Â']

def applyMagic(self, level, num = 0, force = 0):
    from random import randint
    l = level
    option = {}
    position = self['°èÃş']
    if position == '':
        return
    if self['Á¾·ù'] != '¹«±â' and self['Á¾·ù'] != '¹æ¾î±¸':
        return
    if self['¿É¼Ç'] != None and self['¿É¼Ç'] != "":
        return
    if force == 1:
        level += 500
    else:
       if randint(0, 4) != 0:
           return
    if num == 0:
        num = randint(0, 5 * level / 10001 + 1)
    if randint(0, 10) == 10:
        num += 1
    if randint(0, 20) == 20:
        num += 1
    if randint(0, 50) == 50:
        num += 1

    if force == 1 and num == 0:
        num = 1

    if num == 0:
        return

    if num > 4:
        num = 4

    level += level * (num - 1) / 4

    if level > 10000:
        level = 10000

    optionMap = self.MagicMap[position]
    i = 0
    cnt = 0
    z = False
    while i < num:
        cnt += 1
        if cnt > 8:
            return
        nOp = randint(0, len(self.OptionName) - 1)
        op = self.OptionName[nOp]
        if op in option:
            continue
        maxval = optionMap[op]
        if maxval == 0:
            continue
        #val = randint(0, maxval)
        m = level * maxval / 10000 
        val = randint(int(m / 2), int(m * 1.5))
        if val > maxval:
            val = maxval
        if val == 0:
            continue
       
        if val > maxval * 0.3:
            z = True
       
        if op in ['°ø°İ·Â', '¹æ¾î·Â']:
            self[op] = self[op] + val
        option[op] = val
        i += 1
    self['·¹º§'] = l
    if self['Á¾·ù'] == '¹æ¾î±¸':
        de = self['¹æ¾î·Â']  
        d = int(l / 20)
        d += randint(-d/10, d/10)

        #if d > de * 3:
        #    z = True

        if de < d:
            self['¹æ¾î·Â'] = d

    self.setOption(option)

    name = self['ÀÌ¸§']
    name1 = self.getStrip('ÀÌ¸§')
    print name, self.getOptionStr()

    if num > 2 or z == True:
        self.setAttr('¾ÆÀÌÅÛ¼Ó¼º', '¹ö¸®Áö¸øÇÔ')
        self.setAttr('¾ÆÀÌÅÛ¼Ó¼º', 'ÁÙ¼ö¾øÀ½')

    if name == name1:
        if num < 3:
            self['ÀÌ¸§'] = '[1;34m' + name + '[0;37m'
        elif num == 3:
            self['ÀÌ¸§'] = '[1;37m' + name + '[0;37m'
        elif num == 4:
            self['ÀÌ¸§'] = '[1;33m' + name + '[0;37m'


    
